
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Mkdox curlpipebash by pforret">
      
      
      
        <link rel="canonical" href="https://curlpipebash.com/examples/raw.githubusercontent.com.a3/">
      
      
        <link rel="prev" href="../raw.githubusercontent.com.0c/">
      
      
        <link rel="next" href="../raw.githubusercontent.com.fb/">
      
      
        <link rel="alternate" type="application/rss+xml" title="RSS feed" href="../../feed_rss_created.xml">
        <link rel="alternate" type="application/rss+xml" title="RSS feed of updated content" href="../../feed_rss_updated.xml">
      
      <link rel="icon" href="../../icon/android-chrome-192x192.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.34">
    
    
      
        <title>/Homebrew/install/HEAD/install.sh - curl | bash</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.35f28582.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nunito:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Nunito";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  <!-- your analytics script -->
  
    <script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#homebrewinstallheadinstallsh" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="curl | bash" class="md-header__button md-logo" aria-label="curl | bash" data-md-component="logo">
      
  <img src="../../icon/android-chrome-192x192.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            curl | bash
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              /Homebrew/install/HEAD/install.sh
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  curl | bash

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../about/" class="md-tabs__link">
          
  
  About

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../blog/" class="md-tabs__link">
          
  
  Blog

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../frankenphp.dev.5a/" class="md-tabs__link">
          
  
  Examples

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="curl | bash" class="md-nav__button md-logo" aria-label="curl | bash" data-md-component="logo">
      
  <img src="../../icon/android-chrome-192x192.png" alt="logo">

    </a>
    curl | bash
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    curl | bash
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    About
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            About
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About this site
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Features
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Features
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/features/extensions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Markdown Extensions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/features/plugins/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installed plugins
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Blog
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Blog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../blog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    News
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Archive
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Archive
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../blog/archive/2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2024
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Categories
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Categories
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../blog/category/content/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Content
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../blog/category/fake/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fake
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frankenphp.dev.5a/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    frankenphp.dev/install.sh
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../get.docker.com.ff/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    get.docker.com
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../install.sandstorm.io.69/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    install.sandstorm.io
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../laravel.build.ce/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    laravel.build/example-app
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../php.new.d9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    php.new/install/mac/8.4
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../raw.githubusercontent.com.0c/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    /basherpm/basher/master/install.sh
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    /Homebrew/install/HEAD/install.sh
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    /Homebrew/install/HEAD/install.sh
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#description" class="md-nav__link">
    <span class="md-ellipsis">
      Description
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stats" class="md-nav__link">
    <span class="md-ellipsis">
      Stats
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code" class="md-nav__link">
    <span class="md-ellipsis">
      Code
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../raw.githubusercontent.com.fb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    /nvm-sh/nvm/v0.40.1/install.sh
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sdk.cloud.google.com.5a/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sdk.cloud.google.com
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="homebrewinstallheadinstallsh">/Homebrew/install/HEAD/install.sh<a class="headerlink" href="#homebrewinstallheadinstallsh" title="Permanent link">&para;</a></h1>
<h2 id="description">Description<a class="headerlink" href="#description" title="Permanent link">&para;</a></h2>
<ul>
<li>run <code>curl -s https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh | bash</code> to install homebrew, MacOS package manager</li>
<li>cf <a href="https://brew.sh/">https://brew.sh/</a> </li>
</ul>
<h2 id="stats">Stats<a class="headerlink" href="#stats" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
Bourne Shell                     1            127             58            933
-------------------------------------------------------------------------------
</code></pre></div>
<h2 id="code">Code<a class="headerlink" href="#code" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># We don&#39;t need return codes for &quot;$(command)&quot;, only stdout is needed.</span>
<span class="c1"># Allow `[[ -n &quot;$(command)&quot; ]]`, `func &quot;$(command)&quot;`, pipes, etc.</span>
<span class="c1"># shellcheck disable=SC2312</span>

<span class="nb">set</span><span class="w"> </span>-u

abort<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;%s\n&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span><span class="w"> </span>&gt;<span class="p">&amp;</span><span class="m">2</span>
<span class="w">  </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
<span class="o">}</span>

<span class="c1"># Fail fast with a concise message when not using bash</span>
<span class="c1"># Single brackets are needed here for POSIX compatibility</span>
<span class="c1"># shellcheck disable=SC2292</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>-z<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">BASH_VERSION</span><span class="k">:-</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span>
<span class="k">then</span>
<span class="w">  </span>abort<span class="w"> </span><span class="s2">&quot;Bash is required to interpret this script.&quot;</span>
<span class="k">fi</span>

<span class="c1"># Check if script is run with force-interactive mode in CI</span>
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CI</span><span class="p">-</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">INTERACTIVE</span><span class="p">-</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span>abort<span class="w"> </span><span class="s2">&quot;Cannot run force-interactive mode in CI.&quot;</span>
<span class="k">fi</span>

<span class="c1"># Check if both `INTERACTIVE` and `NONINTERACTIVE` are set</span>
<span class="c1"># Always use single-quoted strings with `exp` expressions</span>
<span class="c1"># shellcheck disable=SC2016</span>
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">INTERACTIVE</span><span class="p">-</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">NONINTERACTIVE</span><span class="p">-</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span>abort<span class="w"> </span><span class="s1">&#39;Both `$INTERACTIVE` and `$NONINTERACTIVE` are set. Please unset at least one variable and try again.&#39;</span>
<span class="k">fi</span>

<span class="c1"># Check if script is run in POSIX mode</span>
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">POSIXLY_CORRECT</span><span class="p">+1</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span>abort<span class="w"> </span><span class="s1">&#39;Bash must not run in POSIX mode. Please unset POSIXLY_CORRECT and try again.&#39;</span>
<span class="k">fi</span>

<span class="c1"># string formatters</span>
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-t<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span>tty_escape<span class="o">()</span><span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;\033[%sm&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="o">}</span>
<span class="k">else</span>
<span class="w">  </span>tty_escape<span class="o">()</span><span class="w"> </span><span class="o">{</span><span class="w"> </span>:<span class="p">;</span><span class="w"> </span><span class="o">}</span>
<span class="k">fi</span>
tty_mkbold<span class="o">()</span><span class="w"> </span><span class="o">{</span><span class="w"> </span>tty_escape<span class="w"> </span><span class="s2">&quot;1;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="o">}</span>
<span class="nv">tty_underline</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>tty_escape<span class="w"> </span><span class="s2">&quot;4;39&quot;</span><span class="k">)</span><span class="s2">&quot;</span>
<span class="nv">tty_blue</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>tty_mkbold<span class="w"> </span><span class="m">34</span><span class="k">)</span><span class="s2">&quot;</span>
<span class="nv">tty_red</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>tty_mkbold<span class="w"> </span><span class="m">31</span><span class="k">)</span><span class="s2">&quot;</span>
<span class="nv">tty_bold</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>tty_mkbold<span class="w"> </span><span class="m">39</span><span class="k">)</span><span class="s2">&quot;</span>
<span class="nv">tty_reset</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>tty_escape<span class="w"> </span><span class="m">0</span><span class="k">)</span><span class="s2">&quot;</span>

shell_join<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="nb">local</span><span class="w"> </span>arg
<span class="w">  </span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;%s&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="nb">shift</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span>arg<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">do</span>
<span class="w">    </span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot; &quot;</span>
<span class="w">    </span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;%s&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">arg</span><span class="p">// /</span><span class="se">\ </span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">done</span>
<span class="o">}</span>

chomp<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;%s&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">1</span><span class="p">/</span><span class="s2">&quot;</span>$<span class="s2">&#39;\n&#39;&quot;</span><span class="p">/</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="o">}</span>

ohai<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">tty_blue</span><span class="si">}</span><span class="s2">==&gt;</span><span class="si">${</span><span class="nv">tty_bold</span><span class="si">}</span><span class="s2"> %s</span><span class="si">${</span><span class="nv">tty_reset</span><span class="si">}</span><span class="s2">\n&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>shell_join<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span><span class="k">)</span><span class="s2">&quot;</span>
<span class="o">}</span>

warn<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">tty_red</span><span class="si">}</span><span class="s2">Warning</span><span class="si">${</span><span class="nv">tty_reset</span><span class="si">}</span><span class="s2">: %s\n&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>chomp<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span>&gt;<span class="p">&amp;</span><span class="m">2</span>
<span class="o">}</span>

usage<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span>cat<span class="w"> </span><span class="s">&lt;&lt;EOS</span>
<span class="s">Homebrew Installer</span>
<span class="s">Usage: [NONINTERACTIVE=1] [CI=1] install.sh [options]</span>
<span class="s">    -h, --help       Display this message.</span>
<span class="s">    NONINTERACTIVE   Install without prompting for user input</span>
<span class="s">    CI               Install in CI mode (e.g. do not prompt for user input)</span>
<span class="s">EOS</span>
<span class="w">  </span><span class="nb">exit</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">1</span><span class="k">:-</span><span class="nv">0</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="o">}</span>

<span class="k">while</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="nv">$#</span><span class="w"> </span>-gt<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]]</span>
<span class="k">do</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">in</span>
<span class="w">    </span>-h<span class="w"> </span><span class="p">|</span><span class="w"> </span>--help<span class="o">)</span><span class="w"> </span>usage<span class="w"> </span><span class="p">;;</span>
<span class="w">    </span>*<span class="o">)</span>
<span class="w">      </span>warn<span class="w"> </span><span class="s2">&quot;Unrecognized option: &#39;</span><span class="nv">$1</span><span class="s2">&#39;&quot;</span>
<span class="w">      </span>usage<span class="w"> </span><span class="m">1</span>
<span class="w">      </span><span class="p">;;</span>
<span class="w">  </span><span class="k">esac</span>
<span class="k">done</span>

<span class="c1"># Check if script is run non-interactively (e.g. CI)</span>
<span class="c1"># If it is run non-interactively we should not prompt for passwords.</span>
<span class="c1"># Always use single-quoted strings with `exp` expressions</span>
<span class="c1"># shellcheck disable=SC2016</span>
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-z<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">NONINTERACTIVE</span><span class="p">-</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CI</span><span class="p">-</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span>warn<span class="w"> </span><span class="s1">&#39;Running in non-interactive mode because `$CI` is set.&#39;</span>
<span class="w">    </span><span class="nv">NONINTERACTIVE</span><span class="o">=</span><span class="m">1</span>
<span class="w">  </span><span class="k">elif</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>!<span class="w"> </span>-t<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-z<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">INTERACTIVE</span><span class="p">-</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">    </span><span class="k">then</span>
<span class="w">      </span>warn<span class="w"> </span><span class="s1">&#39;Running in non-interactive mode because `stdin` is not a TTY.&#39;</span>
<span class="w">      </span><span class="nv">NONINTERACTIVE</span><span class="o">=</span><span class="m">1</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">      </span>warn<span class="w"> </span><span class="s1">&#39;Running in interactive mode despite `stdin` not being a TTY because `$INTERACTIVE` is set.&#39;</span>
<span class="w">    </span><span class="k">fi</span>
<span class="w">  </span><span class="k">fi</span>
<span class="k">else</span>
<span class="w">  </span>ohai<span class="w"> </span><span class="s1">&#39;Running in non-interactive mode because `$NONINTERACTIVE` is set.&#39;</span>
<span class="k">fi</span>

<span class="c1"># USER isn&#39;t always set so provide a fall back for the installer and subprocesses.</span>
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-z<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">USER</span><span class="p">-</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span><span class="nv">USER</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>chomp<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>id<span class="w"> </span>-un<span class="k">)</span><span class="s2">&quot;</span><span class="k">)</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="nb">export</span><span class="w"> </span>USER
<span class="k">fi</span>

<span class="c1"># First check OS.</span>
<span class="nv">OS</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>uname<span class="k">)</span><span class="s2">&quot;</span>
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">OS</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;Linux&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span><span class="nv">HOMEBREW_ON_LINUX</span><span class="o">=</span><span class="m">1</span>
<span class="k">elif</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">OS</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;Darwin&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span><span class="nv">HOMEBREW_ON_MACOS</span><span class="o">=</span><span class="m">1</span>
<span class="k">else</span>
<span class="w">  </span>abort<span class="w"> </span><span class="s2">&quot;Homebrew is only supported on macOS and Linux.&quot;</span>
<span class="k">fi</span>

<span class="c1"># Required installation paths. To install elsewhere (which is unsupported)</span>
<span class="c1"># you can untar https://github.com/Homebrew/brew/tarball/master</span>
<span class="c1"># anywhere you like.</span>
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_ON_MACOS</span><span class="p">-</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span><span class="nv">UNAME_MACHINE</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>/usr/bin/uname<span class="w"> </span>-m<span class="k">)</span><span class="s2">&quot;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">UNAME_MACHINE</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;arm64&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span><span class="c1"># On ARM macOS, this script installs to /opt/homebrew only</span>
<span class="w">    </span><span class="nv">HOMEBREW_PREFIX</span><span class="o">=</span><span class="s2">&quot;/opt/homebrew&quot;</span>
<span class="w">    </span><span class="nv">HOMEBREW_REPOSITORY</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_PREFIX</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">else</span>
<span class="w">    </span><span class="c1"># On Intel macOS, this script installs to /usr/local only</span>
<span class="w">    </span><span class="nv">HOMEBREW_PREFIX</span><span class="o">=</span><span class="s2">&quot;/usr/local&quot;</span>
<span class="w">    </span><span class="nv">HOMEBREW_REPOSITORY</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_PREFIX</span><span class="si">}</span><span class="s2">/Homebrew&quot;</span>
<span class="w">  </span><span class="k">fi</span>
<span class="w">  </span><span class="nv">HOMEBREW_CACHE</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">/Library/Caches/Homebrew&quot;</span>

<span class="w">  </span><span class="nv">STAT_PRINTF</span><span class="o">=(</span><span class="s2">&quot;/usr/bin/stat&quot;</span><span class="w"> </span><span class="s2">&quot;-f&quot;</span><span class="o">)</span>
<span class="w">  </span><span class="nv">PERMISSION_FORMAT</span><span class="o">=</span><span class="s2">&quot;%A&quot;</span>
<span class="w">  </span><span class="nv">CHOWN</span><span class="o">=(</span><span class="s2">&quot;/usr/sbin/chown&quot;</span><span class="o">)</span>
<span class="w">  </span><span class="nv">CHGRP</span><span class="o">=(</span><span class="s2">&quot;/usr/bin/chgrp&quot;</span><span class="o">)</span>
<span class="w">  </span><span class="nv">GROUP</span><span class="o">=</span><span class="s2">&quot;admin&quot;</span>
<span class="w">  </span><span class="nv">TOUCH</span><span class="o">=(</span><span class="s2">&quot;/usr/bin/touch&quot;</span><span class="o">)</span>
<span class="w">  </span><span class="nv">INSTALL</span><span class="o">=(</span><span class="s2">&quot;/usr/bin/install&quot;</span><span class="w"> </span>-d<span class="w"> </span>-o<span class="w"> </span><span class="s2">&quot;root&quot;</span><span class="w"> </span>-g<span class="w"> </span><span class="s2">&quot;wheel&quot;</span><span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;0755&quot;</span><span class="o">)</span>
<span class="k">else</span>
<span class="w">  </span><span class="nv">UNAME_MACHINE</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>uname<span class="w"> </span>-m<span class="k">)</span><span class="s2">&quot;</span>

<span class="w">  </span><span class="c1"># On Linux, this script installs to /home/linuxbrew/.linuxbrew only</span>
<span class="w">  </span><span class="nv">HOMEBREW_PREFIX</span><span class="o">=</span><span class="s2">&quot;/home/linuxbrew/.linuxbrew&quot;</span>
<span class="w">  </span><span class="nv">HOMEBREW_REPOSITORY</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_PREFIX</span><span class="si">}</span><span class="s2">/Homebrew&quot;</span>
<span class="w">  </span><span class="nv">HOMEBREW_CACHE</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">/.cache/Homebrew&quot;</span>

<span class="w">  </span><span class="nv">STAT_PRINTF</span><span class="o">=(</span><span class="s2">&quot;/usr/bin/stat&quot;</span><span class="w"> </span><span class="s2">&quot;--printf&quot;</span><span class="o">)</span>
<span class="w">  </span><span class="nv">PERMISSION_FORMAT</span><span class="o">=</span><span class="s2">&quot;%a&quot;</span>
<span class="w">  </span><span class="nv">CHOWN</span><span class="o">=(</span><span class="s2">&quot;/bin/chown&quot;</span><span class="o">)</span>
<span class="w">  </span><span class="nv">CHGRP</span><span class="o">=(</span><span class="s2">&quot;/bin/chgrp&quot;</span><span class="o">)</span>
<span class="w">  </span><span class="nv">GROUP</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>id<span class="w"> </span>-gn<span class="k">)</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="nv">TOUCH</span><span class="o">=(</span><span class="s2">&quot;/bin/touch&quot;</span><span class="o">)</span>
<span class="w">  </span><span class="nv">INSTALL</span><span class="o">=(</span><span class="s2">&quot;/usr/bin/install&quot;</span><span class="w"> </span>-d<span class="w"> </span>-o<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">USER</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-g<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">GROUP</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;0755&quot;</span><span class="o">)</span>
<span class="k">fi</span>
<span class="nv">CHMOD</span><span class="o">=(</span><span class="s2">&quot;/bin/chmod&quot;</span><span class="o">)</span>
<span class="nv">MKDIR</span><span class="o">=(</span><span class="s2">&quot;/bin/mkdir&quot;</span><span class="w"> </span><span class="s2">&quot;-p&quot;</span><span class="o">)</span>
<span class="nv">HOMEBREW_BREW_DEFAULT_GIT_REMOTE</span><span class="o">=</span><span class="s2">&quot;https://github.com/Homebrew/brew&quot;</span>
<span class="nv">HOMEBREW_CORE_DEFAULT_GIT_REMOTE</span><span class="o">=</span><span class="s2">&quot;https://github.com/Homebrew/homebrew-core&quot;</span>

<span class="c1"># Use remote URLs of Homebrew repositories from environment if set.</span>
<span class="nv">HOMEBREW_BREW_GIT_REMOTE</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_BREW_GIT_REMOTE</span><span class="k">:-</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_BREW_DEFAULT_GIT_REMOTE</span><span class="si">}</span><span class="s2">&quot;</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="nv">HOMEBREW_CORE_GIT_REMOTE</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_CORE_GIT_REMOTE</span><span class="k">:-</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_CORE_DEFAULT_GIT_REMOTE</span><span class="si">}</span><span class="s2">&quot;</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="c1"># The URLs with and without the &#39;.git&#39; suffix are the same Git remote. Do not prompt.</span>
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_BREW_GIT_REMOTE</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_BREW_DEFAULT_GIT_REMOTE</span><span class="si">}</span><span class="s2">.git&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span><span class="nv">HOMEBREW_BREW_GIT_REMOTE</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_BREW_DEFAULT_GIT_REMOTE</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">fi</span>
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_CORE_GIT_REMOTE</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_CORE_DEFAULT_GIT_REMOTE</span><span class="si">}</span><span class="s2">.git&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span><span class="nv">HOMEBREW_CORE_GIT_REMOTE</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_CORE_DEFAULT_GIT_REMOTE</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">fi</span>
<span class="nb">export</span><span class="w"> </span>HOMEBREW_<span class="o">{</span>BREW,CORE<span class="o">}</span>_GIT_REMOTE

<span class="c1"># TODO: bump version when new macOS is released or announced</span>
<span class="nv">MACOS_NEWEST_UNSUPPORTED</span><span class="o">=</span><span class="s2">&quot;16.0&quot;</span>
<span class="c1"># TODO: bump version when new macOS is released</span>
<span class="nv">MACOS_OLDEST_SUPPORTED</span><span class="o">=</span><span class="s2">&quot;13.0&quot;</span>

<span class="c1"># For Homebrew on Linux</span>
<span class="nv">REQUIRED_RUBY_VERSION</span><span class="o">=</span><span class="m">2</span>.6<span class="w">    </span><span class="c1"># https://github.com/Homebrew/brew/pull/6556</span>
<span class="nv">REQUIRED_GLIBC_VERSION</span><span class="o">=</span><span class="m">2</span>.13<span class="w">  </span><span class="c1"># https://docs.brew.sh/Homebrew-on-Linux#requirements</span>
<span class="nv">REQUIRED_CURL_VERSION</span><span class="o">=</span><span class="m">7</span>.41.0<span class="w"> </span><span class="c1"># HOMEBREW_MINIMUM_CURL_VERSION in brew.sh in Homebrew/brew</span>
<span class="nv">REQUIRED_GIT_VERSION</span><span class="o">=</span><span class="m">2</span>.7.0<span class="w">   </span><span class="c1"># HOMEBREW_MINIMUM_GIT_VERSION in brew.sh in Homebrew/brew</span>

<span class="c1"># no analytics during installation</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">HOMEBREW_NO_ANALYTICS_THIS_RUN</span><span class="o">=</span><span class="m">1</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">HOMEBREW_NO_ANALYTICS_MESSAGE_OUTPUT</span><span class="o">=</span><span class="m">1</span>

<span class="nb">unset</span><span class="w"> </span>HAVE_SUDO_ACCESS<span class="w"> </span><span class="c1"># unset this from the environment</span>

have_sudo_access<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>!<span class="w"> </span>-x<span class="w"> </span><span class="s2">&quot;/usr/bin/sudo&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="m">1</span>
<span class="w">  </span><span class="k">fi</span>

<span class="w">  </span><span class="nb">local</span><span class="w"> </span>-a<span class="w"> </span><span class="nv">SUDO</span><span class="o">=(</span><span class="s2">&quot;/usr/bin/sudo&quot;</span><span class="o">)</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SUDO_ASKPASS</span><span class="p">-</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span><span class="nv">SUDO</span><span class="o">+=(</span><span class="s2">&quot;-A&quot;</span><span class="o">)</span>
<span class="w">  </span><span class="k">elif</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">NONINTERACTIVE</span><span class="p">-</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span><span class="nv">SUDO</span><span class="o">+=(</span><span class="s2">&quot;-n&quot;</span><span class="o">)</span>
<span class="w">  </span><span class="k">fi</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-z<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HAVE_SUDO_ACCESS</span><span class="p">-</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">NONINTERACTIVE</span><span class="p">-</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">    </span><span class="k">then</span>
<span class="w">      </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SUDO</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-l<span class="w"> </span>mkdir<span class="w"> </span><span class="p">&amp;</span>&gt;/dev/null
<span class="w">    </span><span class="k">else</span>
<span class="w">      </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SUDO</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-v<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SUDO</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-l<span class="w"> </span>mkdir<span class="w"> </span><span class="p">&amp;</span>&gt;/dev/null
<span class="w">    </span><span class="k">fi</span>
<span class="w">    </span><span class="nv">HAVE_SUDO_ACCESS</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$?</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">fi</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_ON_MACOS</span><span class="p">-</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HAVE_SUDO_ACCESS</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-ne<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span>abort<span class="w"> </span><span class="s2">&quot;Need sudo access on macOS (e.g. the user </span><span class="si">${</span><span class="nv">USER</span><span class="si">}</span><span class="s2"> needs to be an Administrator)!&quot;</span>
<span class="w">  </span><span class="k">fi</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HAVE_SUDO_ACCESS</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="o">}</span>

execute<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span>!<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span>abort<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;Failed during: %s&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>shell_join<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span><span class="k">)</span><span class="s2">&quot;</span><span class="k">)</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">fi</span>
<span class="o">}</span>

execute_sudo<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="nb">local</span><span class="w"> </span>-a<span class="w"> </span><span class="nv">args</span><span class="o">=(</span><span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span><span class="o">)</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">EUID</span><span class="k">:-</span><span class="si">${</span><span class="nv">UID</span><span class="si">}}</span><span class="s2">&quot;</span><span class="w"> </span>!<span class="o">=</span><span class="w"> </span><span class="s2">&quot;0&quot;</span><span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>have_sudo_access
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SUDO_ASKPASS</span><span class="p">-</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">    </span><span class="k">then</span>
<span class="w">      </span><span class="nv">args</span><span class="o">=(</span><span class="s2">&quot;-A&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">args</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">)</span>
<span class="w">    </span><span class="k">fi</span>
<span class="w">    </span>ohai<span class="w"> </span><span class="s2">&quot;/usr/bin/sudo&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">args</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">    </span>execute<span class="w"> </span><span class="s2">&quot;/usr/bin/sudo&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">args</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">else</span>
<span class="w">    </span>ohai<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">args</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">    </span>execute<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">args</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">fi</span>
<span class="o">}</span>

getc<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="nb">local</span><span class="w"> </span>save_state
<span class="w">  </span><span class="nv">save_state</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>/bin/stty<span class="w"> </span>-g<span class="k">)</span><span class="s2">&quot;</span>
<span class="w">  </span>/bin/stty<span class="w"> </span>raw<span class="w"> </span>-echo
<span class="w">  </span><span class="nv">IFS</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="nb">read</span><span class="w"> </span>-r<span class="w"> </span>-n<span class="w"> </span><span class="m">1</span><span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span>
<span class="w">  </span>/bin/stty<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">save_state</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="o">}</span>

ring_bell<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="c1"># Use the shell&#39;s audible bell.</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-t<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;\a&quot;</span>
<span class="w">  </span><span class="k">fi</span>
<span class="o">}</span>

wait_for_user<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="nb">local</span><span class="w"> </span>c
<span class="w">  </span><span class="nb">echo</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Press </span><span class="si">${</span><span class="nv">tty_bold</span><span class="si">}</span><span class="s2">RETURN</span><span class="si">${</span><span class="nv">tty_reset</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">tty_bold</span><span class="si">}</span><span class="s2">ENTER</span><span class="si">${</span><span class="nv">tty_reset</span><span class="si">}</span><span class="s2"> to continue or any other key to </span>
<span class="s2">abort:&quot;</span>
<span class="w">  </span>getc<span class="w"> </span>c
<span class="w">  </span><span class="c1"># we test for \r and \n because some stuff does \r instead</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span>!<span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">c</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">$&#39;\r&#39;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">c</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">$&#39;\n&#39;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
<span class="w">  </span><span class="k">fi</span>
<span class="o">}</span>

major_minor<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">1</span><span class="p">%%.*</span><span class="si">}</span><span class="s2">.</span><span class="k">$(</span>
<span class="w">    </span><span class="nv">x</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">1</span><span class="p">#*.</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">x</span><span class="p">%%.*</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">)</span><span class="s2">&quot;</span>
<span class="o">}</span>

version_gt<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">1</span><span class="p">%.*</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-gt<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">2</span><span class="p">%.*</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">1</span><span class="p">%.*</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-eq<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">2</span><span class="p">%.*</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">1</span><span class="p">#*.</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-gt<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">2</span><span class="p">#*.</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="o">}</span>
version_ge<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">1</span><span class="p">%.*</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-gt<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">2</span><span class="p">%.*</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">1</span><span class="p">%.*</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-eq<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">2</span><span class="p">%.*</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">1</span><span class="p">#*.</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-ge<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">2</span><span class="p">#*.</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="o">}</span>
version_lt<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">1</span><span class="p">%.*</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-lt<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">2</span><span class="p">%.*</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">1</span><span class="p">%.*</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-eq<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">2</span><span class="p">%.*</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">1</span><span class="p">#*.</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-lt<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">2</span><span class="p">#*.</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="o">}</span>

check_run_command_as_root<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">EUID</span><span class="k">:-</span><span class="si">${</span><span class="nv">UID</span><span class="si">}}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;0&quot;</span><span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="k">return</span>

<span class="w">  </span><span class="c1"># Allow Azure Pipelines/GitHub Actions/Docker/Concourse/Kubernetes to do everything as root (as it&#39;s normal </span>
there<span class="o">)</span>
<span class="w">  </span><span class="o">[[</span><span class="w"> </span>-f<span class="w"> </span>/.dockerenv<span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="k">return</span>
<span class="w">  </span><span class="o">[[</span><span class="w"> </span>-f<span class="w"> </span>/run/.containerenv<span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="k">return</span>
<span class="w">  </span><span class="o">[[</span><span class="w"> </span>-f<span class="w"> </span>/proc/1/cgroup<span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>grep<span class="w"> </span>-E<span class="w"> </span><span class="s2">&quot;azpl_job|actions_job|docker|garden|kubepods&quot;</span><span class="w"> </span>-q<span class="w"> </span>/proc/1/cgroup<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="k">return</span>

<span class="w">  </span>abort<span class="w"> </span><span class="s2">&quot;Don&#39;t run this as root!&quot;</span>
<span class="o">}</span>

should_install_command_line_tools<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_ON_LINUX</span><span class="p">-</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="m">1</span>
<span class="w">  </span><span class="k">fi</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span>version_gt<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">macos_version</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;10.13&quot;</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span>!<span class="w"> </span><span class="o">[[</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;/Library/Developer/CommandLineTools/usr/bin/git&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">else</span>
<span class="w">    </span>!<span class="w"> </span><span class="o">[[</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;/Library/Developer/CommandLineTools/usr/bin/git&quot;</span><span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">||</span>
<span class="w">      </span>!<span class="w"> </span><span class="o">[[</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;/usr/include/iconv.h&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">fi</span>
<span class="o">}</span>

get_permission<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">STAT_PRINTF</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">PERMISSION_FORMAT</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
<span class="o">}</span>

user_only_chmod<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="o">[[</span><span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>get_permission<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span>!<span class="o">=</span><span class="w"> </span><span class="m">75</span><span class="o">[</span><span class="m">0145</span><span class="o">]</span><span class="w"> </span><span class="o">]]</span>
<span class="o">}</span>

exists_but_not_writable<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="o">[[</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>!<span class="w"> </span><span class="o">[[</span><span class="w"> </span>-r<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>-w<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>-x<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="o">}</span>

get_owner<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">STAT_PRINTF</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;%u&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
<span class="o">}</span>

file_not_owned<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>get_owner<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span>!<span class="o">=</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>id<span class="w"> </span>-u<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="o">}</span>

get_group<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">STAT_PRINTF</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;%g&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
<span class="o">}</span>

file_not_grpowned<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot; </span><span class="k">$(</span>id<span class="w"> </span>-G<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">USER</span><span class="si">}</span><span class="s2">&quot;</span><span class="k">)</span><span class="s2"> &quot;</span><span class="w"> </span>!<span class="o">=</span><span class="w"> </span>*<span class="s2">&quot; </span><span class="k">$(</span>get_group<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="k">)</span><span class="s2"> &quot;</span>*<span class="w"> </span><span class="o">]]</span>
<span class="o">}</span>

<span class="c1"># Please sync with &#39;test_ruby()&#39; in &#39;Library/Homebrew/utils/ruby.sh&#39; from the Homebrew/brew repository.</span>
test_ruby<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>!<span class="w"> </span>-x<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="m">1</span>
<span class="w">  </span><span class="k">fi</span>

<span class="w">  </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="w"> </span>--enable-frozen-string-literal<span class="w"> </span>--disable<span class="o">=</span>gems,did_you_mean,rubyopt<span class="w"> </span>-rrubygems<span class="w"> </span>-e<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="s2">&quot;abort if Gem::Version.new(RUBY_VERSION.to_s.dup).to_s.split(&#39;.&#39;).first(2) != \</span>
<span class="s2">              Gem::Version.new(&#39;</span><span class="si">${</span><span class="nv">REQUIRED_RUBY_VERSION</span><span class="si">}</span><span class="s2">&#39;).to_s.split(&#39;.&#39;).first(2)&quot;</span><span class="w"> </span><span class="m">2</span>&gt;/dev/null
<span class="o">}</span>

test_curl<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>!<span class="w"> </span>-x<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="m">1</span>
<span class="w">  </span><span class="k">fi</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;/snap/bin/curl&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span>warn<span class="w"> </span><span class="s2">&quot;Ignoring </span><span class="nv">$1</span><span class="s2"> (curl snap is too restricted)&quot;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="m">1</span>
<span class="w">  </span><span class="k">fi</span>

<span class="w">  </span><span class="nb">local</span><span class="w"> </span>curl_version_output<span class="w"> </span>curl_name_and_version
<span class="w">  </span><span class="nv">curl_version_output</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="w"> </span>--version<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="k">)</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="nv">curl_name_and_version</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">curl_version_output</span><span class="p">%% (*</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span>version_ge<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>major_minor<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">curl_name_and_version</span><span class="p">##* </span><span class="si">}</span><span class="s2">&quot;</span><span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>major_minor<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">REQUIRED_CURL_VERSION</span><span class="si">}</span><span class="s2">&quot;</span><span class="k">)</span><span class="s2">&quot;</span>
<span class="o">}</span>

test_git<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>!<span class="w"> </span>-x<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="m">1</span>
<span class="w">  </span><span class="k">fi</span>

<span class="w">  </span><span class="nb">local</span><span class="w"> </span>git_version_output
<span class="w">  </span><span class="nv">git_version_output</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="w"> </span>--version<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="k">)</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">git_version_output</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span>~<span class="w"> </span><span class="s2">&quot;git version &quot;</span><span class="o">([</span>^<span class="w"> </span><span class="o">]</span>*<span class="o">)</span>.*<span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span>version_ge<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>major_minor<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">BASH_REMATCH</span><span class="p">[1]</span><span class="si">}</span><span class="s2">&quot;</span><span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>major_minor<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">REQUIRED_GIT_VERSION</span><span class="si">}</span><span class="s2">&quot;</span><span class="k">)</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">else</span>
<span class="w">    </span>abort<span class="w"> </span><span class="s2">&quot;Unexpected Git version: &#39;</span><span class="si">${</span><span class="nv">git_version_output</span><span class="si">}</span><span class="s2">&#39;!&quot;</span>
<span class="w">  </span><span class="k">fi</span>
<span class="o">}</span>

<span class="c1"># Search for the given executable in PATH (avoids a dependency on the `which` command)</span>
which<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="c1"># Alias to Bash built-in command `type -P`</span>
<span class="w">  </span><span class="nb">type</span><span class="w"> </span>-P<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span>
<span class="o">}</span>

<span class="c1"># Search PATH for the specified program that satisfies Homebrew requirements</span>
<span class="c1"># function which is set above</span>
<span class="c1"># shellcheck disable=SC2230</span>
find_tool<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="nv">$#</span><span class="w"> </span>-ne<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="m">1</span>
<span class="w">  </span><span class="k">fi</span>

<span class="w">  </span><span class="nb">local</span><span class="w"> </span>executable
<span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="nb">read</span><span class="w"> </span>-r<span class="w"> </span>executable
<span class="w">  </span><span class="k">do</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">executable</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>!<span class="o">=</span><span class="w"> </span>/*<span class="w"> </span><span class="o">]]</span>
<span class="w">    </span><span class="k">then</span>
<span class="w">      </span>warn<span class="w"> </span><span class="s2">&quot;Ignoring </span><span class="si">${</span><span class="nv">executable</span><span class="si">}</span><span class="s2"> (relative paths don&#39;t work)&quot;</span>
<span class="w">    </span><span class="k">elif</span><span class="w"> </span><span class="s2">&quot;test_</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">executable</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="k">then</span>
<span class="w">      </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">executable</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">      </span><span class="k">break</span>
<span class="w">    </span><span class="k">fi</span>
<span class="w">  </span><span class="k">done</span><span class="w"> </span>&lt;<span class="w"> </span>&lt;<span class="o">(</span>which<span class="w"> </span>-a<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span><span class="o">)</span>
<span class="o">}</span>

no_usable_ruby<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="o">[[</span><span class="w"> </span>-z<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>find_tool<span class="w"> </span>ruby<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="o">}</span>

outdated_glibc<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="nb">local</span><span class="w"> </span>glibc_version
<span class="w">  </span><span class="nv">glibc_version</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>ldd<span class="w"> </span>--version<span class="w"> </span><span class="p">|</span><span class="w"> </span>head<span class="w"> </span>-n1<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-o<span class="w"> </span><span class="s1">&#39;[0-9.]*$&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-o<span class="w"> </span><span class="s1">&#39;^[0-9]\+\.[0-9]\+&#39;</span><span class="k">)</span><span class="s2">&quot;</span>
<span class="w">  </span>version_lt<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">glibc_version</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">REQUIRED_GLIBC_VERSION</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="o">}</span>

<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_ON_LINUX</span><span class="p">-</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>no_usable_ruby<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>outdated_glibc
<span class="k">then</span>
<span class="w">  </span>abort<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>
<span class="w">    </span>cat<span class="w"> </span><span class="s">&lt;&lt;EOABORT</span>
<span class="s">Homebrew requires Ruby ${REQUIRED_RUBY_VERSION} which was not found on your system.</span>
<span class="s">Homebrew portable Ruby requires Glibc version ${REQUIRED_GLIBC_VERSION} or newer,</span>
<span class="s">and your Glibc version is too old. See:</span>
<span class="s">  ${tty_underline}https://docs.brew.sh/Homebrew-on-Linux#requirements${tty_reset}</span>
<span class="s">Please install Ruby ${REQUIRED_RUBY_VERSION} and add its location to your PATH.</span>
<span class="s">EOABORT</span>
<span class="w">  </span><span class="k">)</span><span class="s2">&quot;</span>
<span class="k">fi</span>

<span class="c1"># Invalidate sudo timestamp before exiting (if it wasn&#39;t active before).</span>
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-x<span class="w"> </span>/usr/bin/sudo<span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>!<span class="w"> </span>/usr/bin/sudo<span class="w"> </span>-n<span class="w"> </span>-v<span class="w"> </span><span class="m">2</span>&gt;/dev/null
<span class="k">then</span>
<span class="w">  </span><span class="nb">trap</span><span class="w"> </span><span class="s1">&#39;/usr/bin/sudo -k&#39;</span><span class="w"> </span>EXIT
<span class="k">fi</span>

<span class="c1"># Things can fail later if `pwd` doesn&#39;t exist.</span>
<span class="c1"># Also sudo prints a warning message for no good reason</span>
<span class="nb">cd</span><span class="w"> </span><span class="s2">&quot;/usr&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>

<span class="c1">####################################################################### script</span>

<span class="c1"># shellcheck disable=SC2016</span>
ohai<span class="w"> </span><span class="s1">&#39;Checking for `sudo` access (which may request your password)...&#39;</span>

<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_ON_MACOS</span><span class="p">-</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">EUID</span><span class="k">:-</span><span class="si">${</span><span class="nv">UID</span><span class="si">}}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;0&quot;</span><span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span>have_sudo_access
<span class="k">elif</span><span class="w"> </span>!<span class="w"> </span><span class="o">[[</span><span class="w"> </span>-w<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_PREFIX</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">     </span>!<span class="w"> </span><span class="o">[[</span><span class="w"> </span>-w<span class="w"> </span><span class="s2">&quot;/home/linuxbrew&quot;</span><span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">     </span>!<span class="w"> </span><span class="o">[[</span><span class="w"> </span>-w<span class="w"> </span><span class="s2">&quot;/home&quot;</span><span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">     </span>!<span class="w"> </span>have_sudo_access
<span class="k">then</span>
<span class="w">  </span>abort<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>
<span class="w">    </span>cat<span class="w"> </span><span class="s">&lt;&lt;EOABORT</span>
<span class="s">Insufficient permissions to install Homebrew to &quot;${HOMEBREW_PREFIX}&quot; (the default prefix).</span>

<span class="s">Alternative (unsupported) installation methods are available at:</span>
<span class="s">https://docs.brew.sh/Installation#alternative-installs</span>

<span class="s">Please note this will require most formula to build from source, a buggy, slow and energy-inefficient </span>
<span class="s">experience.</span>
<span class="s">We will close any issues without response for these unsupported configurations.</span>
<span class="s">EOABORT</span>
<span class="w">  </span><span class="k">)</span><span class="s2">&quot;</span>
<span class="k">fi</span>
<span class="nv">HOMEBREW_CORE</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_REPOSITORY</span><span class="si">}</span><span class="s2">/Library/Taps/homebrew/homebrew-core&quot;</span>

check_run_command_as_root

<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_PREFIX</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>!<span class="w"> </span>-x<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_PREFIX</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span>abort<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>
<span class="w">    </span>cat<span class="w"> </span><span class="s">&lt;&lt;EOABORT</span>
<span class="s">The Homebrew prefix ${tty_underline}${HOMEBREW_PREFIX}${tty_reset} exists but is not searchable.</span>
<span class="s">If this is not intentional, please restore the default permissions and</span>
<span class="s">try running the installer again:</span>
<span class="s">    sudo chmod 775 ${HOMEBREW_PREFIX}</span>
<span class="s">EOABORT</span>
<span class="w">  </span><span class="k">)</span><span class="s2">&quot;</span>
<span class="k">fi</span>

<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_ON_MACOS</span><span class="p">-</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span><span class="c1"># On macOS, support 64-bit Intel and ARM</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">UNAME_MACHINE</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>!<span class="o">=</span><span class="w"> </span><span class="s2">&quot;arm64&quot;</span><span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">UNAME_MACHINE</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>!<span class="o">=</span><span class="w"> </span><span class="s2">&quot;x86_64&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span>abort<span class="w"> </span><span class="s2">&quot;Homebrew is only supported on Intel and ARM processors!&quot;</span>
<span class="w">  </span><span class="k">fi</span>
<span class="k">else</span>
<span class="w">  </span><span class="c1"># On Linux, support only 64-bit Intel</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">UNAME_MACHINE</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;aarch64&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span>abort<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>
<span class="w">      </span>cat<span class="w"> </span><span class="s">&lt;&lt;EOABORT</span>
<span class="s">Homebrew on Linux is not supported on ARM processors.</span>
<span class="s">  ${tty_underline}https://docs.brew.sh/Homebrew-on-Linux#arm-unsupported${tty_reset}</span>
<span class="s">EOABORT</span>
<span class="w">    </span><span class="k">)</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">elif</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">UNAME_MACHINE</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>!<span class="o">=</span><span class="w"> </span><span class="s2">&quot;x86_64&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span>abort<span class="w"> </span><span class="s2">&quot;Homebrew on Linux is only supported on Intel processors!&quot;</span>
<span class="w">  </span><span class="k">fi</span>
<span class="k">fi</span>

<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_ON_MACOS</span><span class="p">-</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span><span class="nv">macos_version</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>major_minor<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>/usr/bin/sw_vers<span class="w"> </span>-productVersion<span class="k">)</span><span class="s2">&quot;</span><span class="k">)</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span>version_lt<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">macos_version</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;10.7&quot;</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span>abort<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>
<span class="w">      </span>cat<span class="w"> </span><span class="s">&lt;&lt;EOABORT</span>
<span class="s">Your Mac OS X version is too old. See:</span>
<span class="s">  ${tty_underline}https://github.com/mistydemeo/tigerbrew${tty_reset}</span>
<span class="s">EOABORT</span>
<span class="w">    </span><span class="k">)</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">elif</span><span class="w"> </span>version_lt<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">macos_version</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;10.11&quot;</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span>abort<span class="w"> </span><span class="s2">&quot;Your OS X version is too old.&quot;</span>
<span class="w">  </span><span class="k">elif</span><span class="w"> </span>version_ge<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">macos_version</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">MACOS_NEWEST_UNSUPPORTED</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">||</span>
<span class="w">       </span>version_lt<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">macos_version</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">MACOS_OLDEST_SUPPORTED</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span><span class="nv">who</span><span class="o">=</span><span class="s2">&quot;We&quot;</span>
<span class="w">    </span><span class="nv">what</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span>version_ge<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">macos_version</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">MACOS_NEWEST_UNSUPPORTED</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="k">then</span>
<span class="w">      </span><span class="nv">what</span><span class="o">=</span><span class="s2">&quot;pre-release version&quot;</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">      </span><span class="nv">who</span><span class="o">+=</span><span class="s2">&quot; (and Apple)&quot;</span>
<span class="w">      </span><span class="nv">what</span><span class="o">=</span><span class="s2">&quot;old version&quot;</span>
<span class="w">    </span><span class="k">fi</span>
<span class="w">    </span>ohai<span class="w"> </span><span class="s2">&quot;You are using macOS </span><span class="si">${</span><span class="nv">macos_version</span><span class="si">}</span><span class="s2">.&quot;</span>
<span class="w">    </span>ohai<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">who</span><span class="si">}</span><span class="s2"> do not provide support for this </span><span class="si">${</span><span class="nv">what</span><span class="si">}</span><span class="s2">.&quot;</span>

<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>
<span class="w">      </span>cat<span class="w"> </span><span class="s">&lt;&lt;EOS</span>
<span class="s">This installation may not succeed.</span>
<span class="s">After installation, you will encounter build failures with some formulae.</span>
<span class="s">Please create pull requests instead of asking for help on Homebrew\&#39;s GitHub,</span>
<span class="s">Twitter or any other official channels. You are responsible for resolving any</span>
<span class="s">issues you experience while you are running this ${what}.</span>
<span class="s">EOS</span>
<span class="w">    </span><span class="k">)</span>
<span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>tr<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;\\&quot;</span>
<span class="w">  </span><span class="k">fi</span>
<span class="k">fi</span>

ohai<span class="w"> </span><span class="s2">&quot;This script will install:&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_PREFIX</span><span class="si">}</span><span class="s2">/bin/brew&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_PREFIX</span><span class="si">}</span><span class="s2">/share/doc/homebrew&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_PREFIX</span><span class="si">}</span><span class="s2">/share/man/man1/brew.1&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_PREFIX</span><span class="si">}</span><span class="s2">/share/zsh/site-functions/_brew&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_PREFIX</span><span class="si">}</span><span class="s2">/etc/bash_completion.d/brew&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_REPOSITORY</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="c1"># Keep relatively in sync with</span>
<span class="c1"># https://github.com/Homebrew/brew/blob/master/Library/Homebrew/keg.rb</span>
<span class="nv">directories</span><span class="o">=(</span>
<span class="w">  </span>bin<span class="w"> </span>etc<span class="w"> </span>include<span class="w"> </span>lib<span class="w"> </span>sbin<span class="w"> </span>share<span class="w"> </span>opt<span class="w"> </span>var
<span class="w">  </span>Frameworks
<span class="w">  </span>etc/bash_completion.d<span class="w"> </span>lib/pkgconfig
<span class="w">  </span>share/aclocal<span class="w"> </span>share/doc<span class="w"> </span>share/info<span class="w"> </span>share/locale<span class="w"> </span>share/man
<span class="w">  </span>share/man/man1<span class="w"> </span>share/man/man2<span class="w"> </span>share/man/man3<span class="w"> </span>share/man/man4
<span class="w">  </span>share/man/man5<span class="w"> </span>share/man/man6<span class="w"> </span>share/man/man7<span class="w"> </span>share/man/man8
<span class="w">  </span>var/log<span class="w"> </span>var/homebrew<span class="w"> </span>var/homebrew/linked
<span class="w">  </span>bin/brew
<span class="o">)</span>
<span class="nv">group_chmods</span><span class="o">=()</span>
<span class="k">for</span><span class="w"> </span>dir<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">directories</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">do</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span>exists_but_not_writable<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_PREFIX</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span><span class="nv">group_chmods</span><span class="o">+=(</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_PREFIX</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">)</span>
<span class="w">  </span><span class="k">fi</span>
<span class="k">done</span>

<span class="c1"># zsh refuses to read from these directories if group writable</span>
<span class="nv">directories</span><span class="o">=(</span>share/zsh<span class="w"> </span>share/zsh/site-functions<span class="o">)</span>
<span class="nv">zsh_dirs</span><span class="o">=()</span>
<span class="k">for</span><span class="w"> </span>dir<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">directories</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">do</span>
<span class="w">  </span><span class="nv">zsh_dirs</span><span class="o">+=(</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_PREFIX</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">)</span>
<span class="k">done</span>

<span class="nv">directories</span><span class="o">=(</span>
<span class="w">  </span>bin<span class="w"> </span>etc<span class="w"> </span>include<span class="w"> </span>lib<span class="w"> </span>sbin<span class="w"> </span>share<span class="w"> </span>var<span class="w"> </span>opt
<span class="w">  </span>share/zsh<span class="w"> </span>share/zsh/site-functions
<span class="w">  </span>var/homebrew<span class="w"> </span>var/homebrew/linked
<span class="w">  </span>Cellar<span class="w"> </span>Caskroom<span class="w"> </span>Frameworks
<span class="o">)</span>
<span class="nv">mkdirs</span><span class="o">=()</span>
<span class="k">for</span><span class="w"> </span>dir<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">directories</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">do</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span>!<span class="w"> </span><span class="o">[[</span><span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_PREFIX</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span><span class="nv">mkdirs</span><span class="o">+=(</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_PREFIX</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">)</span>
<span class="w">  </span><span class="k">fi</span>
<span class="k">done</span>

<span class="nv">user_chmods</span><span class="o">=()</span>
<span class="nv">mkdirs_user_only</span><span class="o">=()</span>
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${#</span><span class="nv">zsh_dirs</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-gt<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span>dir<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">zsh_dirs</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">do</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>!<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">    </span><span class="k">then</span>
<span class="w">      </span><span class="nv">mkdirs_user_only</span><span class="o">+=(</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">)</span>
<span class="w">    </span><span class="k">elif</span><span class="w"> </span>user_only_chmod<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="k">then</span>
<span class="w">      </span><span class="nv">user_chmods</span><span class="o">+=(</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">)</span>
<span class="w">    </span><span class="k">fi</span>
<span class="w">  </span><span class="k">done</span>
<span class="k">fi</span>

<span class="nv">chmods</span><span class="o">=()</span>
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${#</span><span class="nv">group_chmods</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-gt<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span><span class="nv">chmods</span><span class="o">+=(</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">group_chmods</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">)</span>
<span class="k">fi</span>
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${#</span><span class="nv">user_chmods</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-gt<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span><span class="nv">chmods</span><span class="o">+=(</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">user_chmods</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">)</span>
<span class="k">fi</span>

<span class="nv">chowns</span><span class="o">=()</span>
<span class="nv">chgrps</span><span class="o">=()</span>
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${#</span><span class="nv">chmods</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-gt<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span>dir<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">chmods</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">do</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span>file_not_owned<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="k">then</span>
<span class="w">      </span><span class="nv">chowns</span><span class="o">+=(</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">)</span>
<span class="w">    </span><span class="k">fi</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span>file_not_grpowned<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="k">then</span>
<span class="w">      </span><span class="nv">chgrps</span><span class="o">+=(</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">)</span>
<span class="w">    </span><span class="k">fi</span>
<span class="w">  </span><span class="k">done</span>
<span class="k">fi</span>

<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${#</span><span class="nv">group_chmods</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-gt<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span>ohai<span class="w"> </span><span class="s2">&quot;The following existing directories will be made group writable:&quot;</span>
<span class="w">  </span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;%s\n&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">group_chmods</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">fi</span>
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${#</span><span class="nv">user_chmods</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-gt<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span>ohai<span class="w"> </span><span class="s2">&quot;The following existing directories will be made writable by user only:&quot;</span>
<span class="w">  </span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;%s\n&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">user_chmods</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">fi</span>
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${#</span><span class="nv">chowns</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-gt<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span>ohai<span class="w"> </span><span class="s2">&quot;The following existing directories will have their owner set to </span><span class="si">${</span><span class="nv">tty_underline</span><span class="si">}${</span><span class="nv">USER</span><span class="si">}${</span><span class="nv">tty_reset</span><span class="si">}</span><span class="s2">:&quot;</span>
<span class="w">  </span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;%s\n&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">chowns</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">fi</span>
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${#</span><span class="nv">chgrps</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-gt<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span>ohai<span class="w"> </span><span class="s2">&quot;The following existing directories will have their group set to </span><span class="si">${</span><span class="nv">tty_underline</span><span class="si">}${</span><span class="nv">GROUP</span><span class="si">}${</span><span class="nv">tty_reset</span><span class="si">}</span><span class="s2">:&quot;</span>
<span class="w">  </span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;%s\n&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">chgrps</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">fi</span>
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${#</span><span class="nv">mkdirs</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-gt<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span>ohai<span class="w"> </span><span class="s2">&quot;The following new directories will be created:&quot;</span>
<span class="w">  </span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;%s\n&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">mkdirs</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">fi</span>

<span class="k">if</span><span class="w"> </span>should_install_command_line_tools
<span class="k">then</span>
<span class="w">  </span>ohai<span class="w"> </span><span class="s2">&quot;The Xcode Command Line Tools will be installed.&quot;</span>
<span class="k">fi</span>

<span class="nv">non_default_repos</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
<span class="nv">additional_shellenv_commands</span><span class="o">=()</span>
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_BREW_DEFAULT_GIT_REMOTE</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>!<span class="o">=</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_BREW_GIT_REMOTE</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span>ohai<span class="w"> </span><span class="s2">&quot;HOMEBREW_BREW_GIT_REMOTE is set to a non-default URL:&quot;</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">tty_underline</span><span class="si">}${</span><span class="nv">HOMEBREW_BREW_GIT_REMOTE</span><span class="si">}${</span><span class="nv">tty_reset</span><span class="si">}</span><span class="s2"> will be used as the Homebrew/brew Git remote.&quot;</span>
<span class="w">  </span><span class="nv">non_default_repos</span><span class="o">=</span><span class="s2">&quot;Homebrew/brew&quot;</span>
<span class="w">  </span><span class="nv">additional_shellenv_commands</span><span class="o">+=(</span><span class="s2">&quot;export HOMEBREW_BREW_GIT_REMOTE=\&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_BREW_GIT_REMOTE</span><span class="si">}</span><span class="s2">\&quot;&quot;</span><span class="o">)</span>
<span class="k">fi</span>

<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_CORE_DEFAULT_GIT_REMOTE</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>!<span class="o">=</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_CORE_GIT_REMOTE</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span>ohai<span class="w"> </span><span class="s2">&quot;HOMEBREW_CORE_GIT_REMOTE is set to a non-default URL:&quot;</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">tty_underline</span><span class="si">}${</span><span class="nv">HOMEBREW_CORE_GIT_REMOTE</span><span class="si">}${</span><span class="nv">tty_reset</span><span class="si">}</span><span class="s2"> will be used as the Homebrew/homebrew-core </span>
<span class="s2">Git remote.&quot;</span>
<span class="w">  </span><span class="nv">non_default_repos</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">non_default_repos</span><span class="k">:-</span><span class="si">}${</span><span class="nv">non_default_repos</span><span class="p">:+ and </span><span class="si">}</span><span class="s2">Homebrew/homebrew-core&quot;</span>
<span class="w">  </span><span class="nv">additional_shellenv_commands</span><span class="o">+=(</span><span class="s2">&quot;export HOMEBREW_CORE_GIT_REMOTE=\&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_CORE_GIT_REMOTE</span><span class="si">}</span><span class="s2">\&quot;&quot;</span><span class="o">)</span>
<span class="k">fi</span>

<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_NO_INSTALL_FROM_API</span><span class="p">-</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span>ohai<span class="w"> </span><span class="s2">&quot;HOMEBREW_NO_INSTALL_FROM_API is set.&quot;</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Homebrew/homebrew-core will be tapped during this </span><span class="si">${</span><span class="nv">tty_bold</span><span class="si">}</span><span class="s2">install</span><span class="si">${</span><span class="nv">tty_reset</span><span class="si">}</span><span class="s2"> run.&quot;</span>
<span class="k">fi</span>

<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-z<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">NONINTERACTIVE</span><span class="p">-</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span>ring_bell
<span class="w">  </span>wait_for_user
<span class="k">fi</span>

<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_PREFIX</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${#</span><span class="nv">chmods</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-gt<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span>execute_sudo<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CHMOD</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;u+rwx&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">chmods</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">fi</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${#</span><span class="nv">group_chmods</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-gt<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span>execute_sudo<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CHMOD</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;g+rwx&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">group_chmods</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">fi</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${#</span><span class="nv">user_chmods</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-gt<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span>execute_sudo<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CHMOD</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;go-w&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">user_chmods</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">fi</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${#</span><span class="nv">chowns</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-gt<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span>execute_sudo<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CHOWN</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">USER</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">chowns</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">fi</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${#</span><span class="nv">chgrps</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-gt<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span>execute_sudo<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CHGRP</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">GROUP</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">chgrps</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">fi</span>
<span class="k">else</span>
<span class="w">  </span>execute_sudo<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">INSTALL</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_PREFIX</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">fi</span>

<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${#</span><span class="nv">mkdirs</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-gt<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span>execute_sudo<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">MKDIR</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">mkdirs</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span>execute_sudo<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CHMOD</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;ug=rwx&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">mkdirs</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${#</span><span class="nv">mkdirs_user_only</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-gt<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span>execute_sudo<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CHMOD</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;go-w&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">mkdirs_user_only</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">fi</span>
<span class="w">  </span>execute_sudo<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CHOWN</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">USER</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">mkdirs</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span>execute_sudo<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CHGRP</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">GROUP</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">mkdirs</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">fi</span>

<span class="k">if</span><span class="w"> </span>!<span class="w"> </span><span class="o">[[</span><span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_REPOSITORY</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span>execute_sudo<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">MKDIR</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_REPOSITORY</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">fi</span>
execute_sudo<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CHOWN</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;-R&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">USER</span><span class="si">}</span><span class="s2">:</span><span class="si">${</span><span class="nv">GROUP</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_REPOSITORY</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="k">if</span><span class="w"> </span>!<span class="w"> </span><span class="o">[[</span><span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_CACHE</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_ON_MACOS</span><span class="p">-</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span>execute_sudo<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">MKDIR</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_CACHE</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">else</span>
<span class="w">    </span>execute<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">MKDIR</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_CACHE</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">fi</span>
<span class="k">fi</span>
<span class="k">if</span><span class="w"> </span>exists_but_not_writable<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_CACHE</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">then</span>
<span class="w">  </span>execute_sudo<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CHMOD</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;g+rwx&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_CACHE</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">fi</span>
<span class="k">if</span><span class="w"> </span>file_not_owned<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_CACHE</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">then</span>
<span class="w">  </span>execute_sudo<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CHOWN</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;-R&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">USER</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_CACHE</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">fi</span>
<span class="k">if</span><span class="w"> </span>file_not_grpowned<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_CACHE</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">then</span>
<span class="w">  </span>execute_sudo<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CHGRP</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;-R&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">GROUP</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_CACHE</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">fi</span>
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_CACHE</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span>execute<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">TOUCH</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_CACHE</span><span class="si">}</span><span class="s2">/.cleaned&quot;</span>
<span class="k">fi</span>

<span class="k">if</span><span class="w"> </span>should_install_command_line_tools<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>version_ge<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">macos_version</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;10.13&quot;</span>
<span class="k">then</span>
<span class="w">  </span>ohai<span class="w"> </span><span class="s2">&quot;Searching online for the Command Line Tools&quot;</span>
<span class="w">  </span><span class="c1"># This temporary file prompts the &#39;softwareupdate&#39; utility to list the Command Line Tools</span>
<span class="w">  </span><span class="nv">clt_placeholder</span><span class="o">=</span><span class="s2">&quot;/tmp/.com.apple.dt.CommandLineTools.installondemand.in-progress&quot;</span>
<span class="w">  </span>execute_sudo<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">TOUCH</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">clt_placeholder</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="w">  </span><span class="nv">clt_label_command</span><span class="o">=</span><span class="s2">&quot;/usr/sbin/softwareupdate -l |</span>
<span class="s2">                      grep -B 1 -E &#39;Command Line Tools&#39; |</span>
<span class="s2">                      awk -F&#39;*&#39; &#39;/^ *\\*/ {print \$2}&#39; |</span>
<span class="s2">                      sed -e &#39;s/^ *Label: //&#39; -e &#39;s/^ *//&#39; |</span>
<span class="s2">                      sort -V |</span>
<span class="s2">                      tail -n1&quot;</span>
<span class="w">  </span><span class="nv">clt_label</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>chomp<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>/bin/bash<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">clt_label_command</span><span class="si">}</span><span class="s2">&quot;</span><span class="k">)</span><span class="s2">&quot;</span><span class="k">)</span><span class="s2">&quot;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">clt_label</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span>ohai<span class="w"> </span><span class="s2">&quot;Installing </span><span class="si">${</span><span class="nv">clt_label</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">    </span>execute_sudo<span class="w"> </span><span class="s2">&quot;/usr/sbin/softwareupdate&quot;</span><span class="w"> </span><span class="s2">&quot;-i&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">clt_label</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">    </span>execute_sudo<span class="w"> </span><span class="s2">&quot;/usr/bin/xcode-select&quot;</span><span class="w"> </span><span class="s2">&quot;--switch&quot;</span><span class="w"> </span><span class="s2">&quot;/Library/Developer/CommandLineTools&quot;</span>
<span class="w">  </span><span class="k">fi</span>
<span class="w">  </span>execute_sudo<span class="w"> </span><span class="s2">&quot;/bin/rm&quot;</span><span class="w"> </span><span class="s2">&quot;-f&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">clt_placeholder</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">fi</span>

<span class="c1"># Headless install may have failed, so fallback to original &#39;xcode-select&#39; method</span>
<span class="k">if</span><span class="w"> </span>should_install_command_line_tools<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">test</span><span class="w"> </span>-t<span class="w"> </span><span class="m">0</span>
<span class="k">then</span>
<span class="w">  </span>ohai<span class="w"> </span><span class="s2">&quot;Installing the Command Line Tools (expect a GUI popup):&quot;</span>
<span class="w">  </span>execute<span class="w"> </span><span class="s2">&quot;/usr/bin/xcode-select&quot;</span><span class="w"> </span><span class="s2">&quot;--install&quot;</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Press any key when the installation has completed.&quot;</span>
<span class="w">  </span>getc
<span class="w">  </span>execute_sudo<span class="w"> </span><span class="s2">&quot;/usr/bin/xcode-select&quot;</span><span class="w"> </span><span class="s2">&quot;--switch&quot;</span><span class="w"> </span><span class="s2">&quot;/Library/Developer/CommandLineTools&quot;</span>
<span class="k">fi</span>

<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_ON_MACOS</span><span class="p">-</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>!<span class="w"> </span><span class="nv">output</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>/usr/bin/xcrun<span class="w"> </span>clang<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">output</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>
*<span class="s2">&quot;license&quot;</span>*<span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span>abort<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>
<span class="w">    </span>cat<span class="w"> </span><span class="s">&lt;&lt;EOABORT</span>
<span class="s">You have not agreed to the Xcode license.</span>
<span class="s">Before running the installer again please agree to the license by opening</span>
<span class="s">Xcode.app or running:</span>
<span class="s">    sudo xcodebuild -license</span>
<span class="s">EOABORT</span>
<span class="w">  </span><span class="k">)</span><span class="s2">&quot;</span>
<span class="k">fi</span>

<span class="nv">USABLE_GIT</span><span class="o">=</span>/usr/bin/git
<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_ON_LINUX</span><span class="p">-</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span><span class="nv">USABLE_GIT</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>find_tool<span class="w"> </span>git<span class="k">)</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-z<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span><span class="nb">command</span><span class="w"> </span>-v<span class="w"> </span>git<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span>abort<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>
<span class="w">      </span>cat<span class="w"> </span><span class="s">&lt;&lt;EOABORT</span>
<span class="s">  You must install Git before installing Homebrew. See:</span>
<span class="s">    ${tty_underline}https://docs.brew.sh/Installation${tty_reset}</span>
<span class="s">EOABORT</span>
<span class="w">    </span><span class="k">)</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">fi</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-z<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">USABLE_GIT</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span>abort<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>
<span class="w">      </span>cat<span class="w"> </span><span class="s">&lt;&lt;EOABORT</span>
<span class="s">  The version of Git that was found does not satisfy requirements for Homebrew.</span>
<span class="s">  Please install Git ${REQUIRED_GIT_VERSION} or newer and add it to your PATH.</span>
<span class="s">EOABORT</span>
<span class="w">    </span><span class="k">)</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">fi</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">USABLE_GIT</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>!<span class="o">=</span><span class="w"> </span>/usr/bin/git<span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span><span class="nb">export</span><span class="w"> </span><span class="nv">HOMEBREW_GIT_PATH</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">USABLE_GIT</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">    </span>ohai<span class="w"> </span><span class="s2">&quot;Found Git: </span><span class="si">${</span><span class="nv">HOMEBREW_GIT_PATH</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">fi</span>
<span class="k">fi</span>

<span class="k">if</span><span class="w"> </span>!<span class="w"> </span><span class="nb">command</span><span class="w"> </span>-v<span class="w"> </span>curl<span class="w"> </span>&gt;/dev/null
<span class="k">then</span>
<span class="w">  </span>abort<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>
<span class="w">    </span>cat<span class="w"> </span><span class="s">&lt;&lt;EOABORT</span>
<span class="s">You must install cURL before installing Homebrew. See:</span>
<span class="s">  ${tty_underline}https://docs.brew.sh/Installation${tty_reset}</span>
<span class="s">EOABORT</span>
<span class="w">  </span><span class="k">)</span><span class="s2">&quot;</span>
<span class="k">elif</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_ON_LINUX</span><span class="p">-</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span><span class="nv">USABLE_CURL</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>find_tool<span class="w"> </span>curl<span class="k">)</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-z<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">USABLE_CURL</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span>abort<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>
<span class="w">      </span>cat<span class="w"> </span><span class="s">&lt;&lt;EOABORT</span>
<span class="s">The version of cURL that was found does not satisfy requirements for Homebrew.</span>
<span class="s">Please install cURL ${REQUIRED_CURL_VERSION} or newer and add it to your PATH.</span>
<span class="s">EOABORT</span>
<span class="w">    </span><span class="k">)</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">elif</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">USABLE_CURL</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>!<span class="o">=</span><span class="w"> </span>/usr/bin/curl<span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span><span class="nb">export</span><span class="w"> </span><span class="nv">HOMEBREW_CURL_PATH</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">USABLE_CURL</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">    </span>ohai<span class="w"> </span><span class="s2">&quot;Found cURL: </span><span class="si">${</span><span class="nv">HOMEBREW_CURL_PATH</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">fi</span>
<span class="k">fi</span>

ohai<span class="w"> </span><span class="s2">&quot;Downloading and installing Homebrew...&quot;</span>
<span class="o">(</span>
<span class="w">  </span><span class="nb">cd</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_REPOSITORY</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="k">return</span>

<span class="w">  </span><span class="c1"># we do it in four steps to avoid merge errors when reinstalling</span>
<span class="w">  </span>execute<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">USABLE_GIT</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;-c&quot;</span><span class="w"> </span><span class="s2">&quot;init.defaultBranch=master&quot;</span><span class="w"> </span><span class="s2">&quot;init&quot;</span><span class="w"> </span><span class="s2">&quot;--quiet&quot;</span>

<span class="w">  </span><span class="c1"># &quot;git remote add&quot; will fail if the remote is defined in the global config</span>
<span class="w">  </span>execute<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">USABLE_GIT</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;config&quot;</span><span class="w"> </span><span class="s2">&quot;remote.origin.url&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_BREW_GIT_REMOTE</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span>execute<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">USABLE_GIT</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;config&quot;</span><span class="w"> </span><span class="s2">&quot;remote.origin.fetch&quot;</span><span class="w"> </span><span class="s2">&quot;+refs/heads/*:refs/remotes/origin/*&quot;</span>

<span class="w">  </span><span class="c1"># ensure we don&#39;t munge line endings on checkout</span>
<span class="w">  </span>execute<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">USABLE_GIT</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;config&quot;</span><span class="w"> </span><span class="s2">&quot;--bool&quot;</span><span class="w"> </span><span class="s2">&quot;core.autocrlf&quot;</span><span class="w"> </span><span class="s2">&quot;false&quot;</span>

<span class="w">  </span><span class="c1"># make sure symlinks are saved as-is</span>
<span class="w">  </span>execute<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">USABLE_GIT</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;config&quot;</span><span class="w"> </span><span class="s2">&quot;--bool&quot;</span><span class="w"> </span><span class="s2">&quot;core.symlinks&quot;</span><span class="w"> </span><span class="s2">&quot;true&quot;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-z<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">NONINTERACTIVE</span><span class="p">-</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span><span class="nv">quiet_progress</span><span class="o">=(</span><span class="s2">&quot;--quiet&quot;</span><span class="w"> </span><span class="s2">&quot;--progress&quot;</span><span class="o">)</span>
<span class="w">  </span><span class="k">else</span>
<span class="w">    </span><span class="nv">quiet_progress</span><span class="o">=(</span><span class="s2">&quot;--quiet&quot;</span><span class="o">)</span>
<span class="w">  </span><span class="k">fi</span>
<span class="w">  </span>execute<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">USABLE_GIT</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;fetch&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">quiet_progress</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;--force&quot;</span><span class="w"> </span><span class="s2">&quot;origin&quot;</span>
<span class="w">  </span>execute<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">USABLE_GIT</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;fetch&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">quiet_progress</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;--force&quot;</span><span class="w"> </span><span class="s2">&quot;--tags&quot;</span><span class="w"> </span><span class="s2">&quot;origin&quot;</span>

<span class="w">  </span>execute<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">USABLE_GIT</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;remote&quot;</span><span class="w"> </span><span class="s2">&quot;set-head&quot;</span><span class="w"> </span><span class="s2">&quot;origin&quot;</span><span class="w"> </span><span class="s2">&quot;--auto&quot;</span><span class="w"> </span>&gt;/dev/null

<span class="w">  </span><span class="nv">LATEST_GIT_TAG</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">USABLE_GIT</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>tag<span class="w"> </span>--list<span class="w"> </span>--sort<span class="o">=</span><span class="s2">&quot;-version:refname&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>head<span class="w"> </span>-n1<span class="k">)</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-z<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">LATEST_GIT_TAG</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span>abort<span class="w"> </span><span class="s2">&quot;Failed to query latest Homebrew/brew Git tag.&quot;</span>
<span class="w">  </span><span class="k">fi</span>
<span class="w">  </span>execute<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">USABLE_GIT</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;checkout&quot;</span><span class="w"> </span><span class="s2">&quot;--quiet&quot;</span><span class="w"> </span><span class="s2">&quot;--force&quot;</span><span class="w"> </span><span class="s2">&quot;-B&quot;</span><span class="w"> </span><span class="s2">&quot;stable&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">LATEST_GIT_TAG</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_REPOSITORY</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>!<span class="o">=</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_PREFIX</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_REPOSITORY</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_PREFIX</span><span class="si">}</span><span class="s2">/Homebrew&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">    </span><span class="k">then</span>
<span class="w">      </span>execute<span class="w"> </span><span class="s2">&quot;ln&quot;</span><span class="w"> </span><span class="s2">&quot;-sf&quot;</span><span class="w"> </span><span class="s2">&quot;../Homebrew/bin/brew&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_PREFIX</span><span class="si">}</span><span class="s2">/bin/brew&quot;</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">      </span>abort<span class="w"> </span><span class="s2">&quot;The Homebrew/brew repository should be placed in the Homebrew prefix directory.&quot;</span>
<span class="w">    </span><span class="k">fi</span>
<span class="w">  </span><span class="k">fi</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_NO_INSTALL_FROM_API</span><span class="p">-</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>!<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_CORE</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span><span class="c1"># Always use single-quoted strings with `exp` expressions</span>
<span class="w">    </span><span class="c1"># shellcheck disable=SC2016</span>
<span class="w">    </span>ohai<span class="w"> </span><span class="s1">&#39;Tapping homebrew/core because `$HOMEBREW_NO_INSTALL_FROM_API` is set.&#39;</span>
<span class="w">    </span><span class="o">(</span>
<span class="w">      </span>execute<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">MKDIR</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_CORE</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">      </span><span class="nb">cd</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_CORE</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="k">return</span>

<span class="w">      </span>execute<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">USABLE_GIT</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;-c&quot;</span><span class="w"> </span><span class="s2">&quot;init.defaultBranch=master&quot;</span><span class="w"> </span><span class="s2">&quot;init&quot;</span><span class="w"> </span><span class="s2">&quot;--quiet&quot;</span>
<span class="w">      </span>execute<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">USABLE_GIT</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;config&quot;</span><span class="w"> </span><span class="s2">&quot;remote.origin.url&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_CORE_GIT_REMOTE</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">      </span>execute<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">USABLE_GIT</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;config&quot;</span><span class="w"> </span><span class="s2">&quot;remote.origin.fetch&quot;</span><span class="w"> </span><span class="s2">&quot;+refs/heads/*:refs/remotes/origin/*&quot;</span>
<span class="w">      </span>execute<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">USABLE_GIT</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;config&quot;</span><span class="w"> </span><span class="s2">&quot;--bool&quot;</span><span class="w"> </span><span class="s2">&quot;core.autocrlf&quot;</span><span class="w"> </span><span class="s2">&quot;false&quot;</span>
<span class="w">      </span>execute<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">USABLE_GIT</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;config&quot;</span><span class="w"> </span><span class="s2">&quot;--bool&quot;</span><span class="w"> </span><span class="s2">&quot;core.symlinks&quot;</span><span class="w"> </span><span class="s2">&quot;true&quot;</span>
<span class="w">      </span>execute<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">USABLE_GIT</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;fetch&quot;</span><span class="w"> </span><span class="s2">&quot;--force&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">quiet_progress</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">        </span><span class="s2">&quot;origin&quot;</span><span class="w"> </span><span class="s2">&quot;refs/heads/master:refs/remotes/origin/master&quot;</span>
<span class="w">      </span>execute<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">USABLE_GIT</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;remote&quot;</span><span class="w"> </span><span class="s2">&quot;set-head&quot;</span><span class="w"> </span><span class="s2">&quot;origin&quot;</span><span class="w"> </span><span class="s2">&quot;--auto&quot;</span><span class="w"> </span>&gt;/dev/null
<span class="w">      </span>execute<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">USABLE_GIT</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;reset&quot;</span><span class="w"> </span><span class="s2">&quot;--hard&quot;</span><span class="w"> </span><span class="s2">&quot;origin/master&quot;</span>

<span class="w">      </span><span class="nb">cd</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_REPOSITORY</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="k">return</span>
<span class="w">    </span><span class="o">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
<span class="w">  </span><span class="k">fi</span>

<span class="w">  </span>execute<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_PREFIX</span><span class="si">}</span><span class="s2">/bin/brew&quot;</span><span class="w"> </span><span class="s2">&quot;update&quot;</span><span class="w"> </span><span class="s2">&quot;--force&quot;</span><span class="w"> </span><span class="s2">&quot;--quiet&quot;</span>
<span class="o">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>

<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;:</span><span class="si">${</span><span class="nv">PATH</span><span class="si">}</span><span class="s2">:&quot;</span><span class="w"> </span>!<span class="o">=</span><span class="w"> </span>*<span class="s2">&quot;:</span><span class="si">${</span><span class="nv">HOMEBREW_PREFIX</span><span class="si">}</span><span class="s2">/bin:&quot;</span>*<span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span>warn<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_PREFIX</span><span class="si">}</span><span class="s2">/bin is not in your PATH.</span>
<span class="s2">  Instructions on how to configure your shell for Homebrew</span>
<span class="s2">  can be found in the &#39;Next steps&#39; section below.&quot;</span>
<span class="k">fi</span>

ohai<span class="w"> </span><span class="s2">&quot;Installation successful!&quot;</span>
<span class="nb">echo</span>

ring_bell

<span class="c1"># Use an extra newline and bold to avoid this being missed.</span>
ohai<span class="w"> </span><span class="s2">&quot;Homebrew has enabled anonymous aggregate formulae and cask analytics.&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>
<span class="w">  </span>cat<span class="w"> </span><span class="s">&lt;&lt;EOS</span>
<span class="s">${tty_bold}Read the analytics documentation (and how to opt-out) here:</span>
<span class="s">  ${tty_underline}https://docs.brew.sh/Analytics${tty_reset}</span>
<span class="s">No analytics data has been sent yet (nor will any be during this ${tty_bold}install${tty_reset} run).</span>
<span class="s">EOS</span>
<span class="k">)</span>
<span class="s2">&quot;</span>

ohai<span class="w"> </span><span class="s2">&quot;Homebrew is run entirely by unpaid volunteers. Please consider donating:&quot;</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>
<span class="w">  </span>cat<span class="w"> </span><span class="s">&lt;&lt;EOS</span>
<span class="s">  ${tty_underline}https://github.com/Homebrew/brew#donations${tty_reset}</span>
<span class="s">EOS</span>
<span class="k">)</span>
<span class="s2">&quot;</span>

<span class="o">(</span>
<span class="w">  </span><span class="nb">cd</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_REPOSITORY</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="k">return</span>
<span class="w">  </span>execute<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">USABLE_GIT</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;config&quot;</span><span class="w"> </span><span class="s2">&quot;--replace-all&quot;</span><span class="w"> </span><span class="s2">&quot;homebrew.analyticsmessage&quot;</span><span class="w"> </span><span class="s2">&quot;true&quot;</span>
<span class="w">  </span>execute<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">USABLE_GIT</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;config&quot;</span><span class="w"> </span><span class="s2">&quot;--replace-all&quot;</span><span class="w"> </span><span class="s2">&quot;homebrew.caskanalyticsmessage&quot;</span><span class="w"> </span><span class="s2">&quot;true&quot;</span>
<span class="o">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>

ohai<span class="w"> </span><span class="s2">&quot;Next steps:&quot;</span>
<span class="k">case</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">SHELL</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">in</span>
<span class="w">  </span>*/bash*<span class="o">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_ON_LINUX</span><span class="p">-</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">    </span><span class="k">then</span>
<span class="w">      </span><span class="nv">shell_rcfile</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">/.bashrc&quot;</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">      </span><span class="nv">shell_rcfile</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">/.bash_profile&quot;</span>
<span class="w">    </span><span class="k">fi</span>
<span class="w">    </span><span class="p">;;</span>
<span class="w">  </span>*/zsh*<span class="o">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_ON_LINUX</span><span class="p">-</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">    </span><span class="k">then</span>
<span class="w">      </span><span class="nv">shell_rcfile</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">ZDOTDIR</span><span class="k">:-</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">&quot;</span><span class="si">}</span><span class="s2">/.zshrc&quot;</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">      </span><span class="nv">shell_rcfile</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">ZDOTDIR</span><span class="k">:-</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">&quot;</span><span class="si">}</span><span class="s2">/.zprofile&quot;</span>
<span class="w">    </span><span class="k">fi</span>
<span class="w">    </span><span class="p">;;</span>
<span class="w">  </span>*/fish*<span class="o">)</span>
<span class="w">    </span><span class="nv">shell_rcfile</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">/.config/fish/config.fish&quot;</span>
<span class="w">    </span><span class="p">;;</span>
<span class="w">  </span>*<span class="o">)</span>
<span class="w">    </span><span class="nv">shell_rcfile</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">ENV</span><span class="k">:-</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">/.profile&quot;</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="p">;;</span>
<span class="k">esac</span>

<span class="k">if</span><span class="w"> </span>grep<span class="w"> </span>-qs<span class="w"> </span><span class="s2">&quot;eval \&quot;\$(</span><span class="si">${</span><span class="nv">HOMEBREW_PREFIX</span><span class="si">}</span><span class="s2">/bin/brew shellenv)\&quot;&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">shell_rcfile</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">then</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span>!<span class="w"> </span><span class="o">[[</span><span class="w"> </span>-x<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span><span class="nb">command</span><span class="w"> </span>-v<span class="w"> </span>brew<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span>cat<span class="w"> </span><span class="s">&lt;&lt;EOS</span>
<span class="s">- Run this command in your terminal to add Homebrew to your ${tty_bold}PATH${tty_reset}:</span>
<span class="s">    eval &quot;\$(${HOMEBREW_PREFIX}/bin/brew shellenv)&quot;</span>
<span class="s">EOS</span>
<span class="w">  </span><span class="k">fi</span>
<span class="k">else</span>
<span class="w">  </span>cat<span class="w"> </span><span class="s">&lt;&lt;EOS</span>
<span class="s">- Run these commands in your terminal to add Homebrew to your ${tty_bold}PATH${tty_reset}:</span>
<span class="s">    echo &gt;&gt; ${shell_rcfile}</span>
<span class="s">    echo &#39;eval &quot;\$(${HOMEBREW_PREFIX}/bin/brew shellenv)&quot;&#39; &gt;&gt; ${shell_rcfile}</span>
<span class="s">    eval &quot;\$(${HOMEBREW_PREFIX}/bin/brew shellenv)&quot;</span>
<span class="s">EOS</span>
<span class="k">fi</span>

<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">non_default_repos</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span><span class="nv">plural</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${#</span><span class="nv">additional_shellenv_commands</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>-gt<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span><span class="nv">plural</span><span class="o">=</span><span class="s2">&quot;s&quot;</span>
<span class="w">  </span><span class="k">fi</span>
<span class="w">  </span><span class="nb">printf</span><span class="w"> </span>--<span class="w"> </span><span class="s2">&quot;- Run these commands in your terminal to add the non-default Git remote%s for %s:\n&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">plural</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>
<span class="s2">&quot;</span><span class="si">${</span><span class="nv">non_default_repos</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;    echo &#39;# Set non-default Git remote%s for %s.&#39; &gt;&gt; %s\n&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">plural</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">non_default_repos</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>
<span class="s2">&quot;</span><span class="si">${</span><span class="nv">shell_rcfile</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;    echo &#39;%s&#39; &gt;&gt; </span><span class="si">${</span><span class="nv">shell_rcfile</span><span class="si">}</span><span class="s2">\n&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">additional_shellenv_commands</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;    %s\n&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">additional_shellenv_commands</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">fi</span>

<span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOMEBREW_ON_LINUX</span><span class="p">-</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="k">then</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;- Install Homebrew&#39;s dependencies if you have sudo access:&quot;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-x<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span><span class="nb">command</span><span class="w"> </span>-v<span class="w"> </span>apt-get<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;    sudo apt-get install build-essential&quot;</span>
<span class="w">  </span><span class="k">elif</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-x<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span><span class="nb">command</span><span class="w"> </span>-v<span class="w"> </span>dnf<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;    sudo dnf group install development-tools&quot;</span>
<span class="w">  </span><span class="k">elif</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-x<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span><span class="nb">command</span><span class="w"> </span>-v<span class="w"> </span>yum<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;    sudo yum groupinstall &#39;Development Tools&#39;&quot;</span>
<span class="w">  </span><span class="k">elif</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-x<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span><span class="nb">command</span><span class="w"> </span>-v<span class="w"> </span>pacman<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;    sudo pacman -S base-devel&quot;</span>
<span class="w">  </span><span class="k">elif</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-x<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span><span class="nb">command</span><span class="w"> </span>-v<span class="w"> </span>apk<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;    sudo apk add build-base&quot;</span>
<span class="w">  </span><span class="k">fi</span>

<span class="w">  </span>cat<span class="w"> </span><span class="s">&lt;&lt;EOS</span>
<span class="s">  For more information, see:</span>
<span class="s">    ${tty_underline}https://docs.brew.sh/Homebrew-on-Linux${tty_reset}</span>
<span class="s">- We recommend that you install GCC:</span>
<span class="s">    brew install gcc</span>
<span class="s">EOS</span>
<span class="k">fi</span>

cat<span class="w"> </span><span class="s">&lt;&lt;EOS</span>
<span class="s">- Run ${tty_bold}brew help${tty_reset} to get started</span>
<span class="s">- Further documentation:</span>
<span class="s">    ${tty_underline}https://docs.brew.sh${tty_reset}</span>

<span class="s">EOS</span>
</code></pre></div>









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2025 Mkdox curlpipebash &bull; pforret
    </div>
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            

  
    
  




  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="analytics" checked>
          <span class="task-list-indicator"></span>
          Google Analytics
        </label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "header.autohide", "navigation.instant", "navigation.integrate", "navigation.tabs", "navigation.tabs.sticky", "navigation.tracking", "search.highlight", "search.suggest", "toc.integrate"], "search": "../../assets/javascripts/workers/search.07f07601.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.56dfad97.min.js"></script>
      
    
  </body>
</html>